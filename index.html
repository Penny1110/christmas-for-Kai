<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Christmas Tree For My Crush</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #000;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        /* Canvasç”»å¸ƒï¼ˆåœ£è¯æ ‘+é›ªèŠ±ï¼‰ */
        #christmasCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        /* æŒ‰é’®å®¹å™¨ï¼ˆæ‚¬æµ®åœ¨ç”»å¸ƒä¸Šï¼‰ */
        .btn-container {
            position: relative;
            z-index: 2;
            margin-top: 20px;
        }
        /* æŒ‰é’®æ ·å¼ï¼ˆåœ£è¯é£ï¼‰ */
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }
        #openLetterBtn {
            background: linear-gradient(45deg, #22c1c3, #fdbb2d);
            color: white;
            box-shadow: 0 0 20px rgba(34, 193, 195, 0.5);
        }
        #openLetterBtn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(34, 193, 195, 0.8);
        }
        /* ä¿¡ä»¶ç…§ç‰‡å®¹å™¨ï¼ˆé»˜è®¤éšè—ï¼‰ */
        #letterContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 3;
            display: none;
            align-items: center;
            justify-content: center;
        }
        #letterImg {
            max-width: 90%;
            max-height: 90vh;
            border: 5px solid #fdbb2d;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(253, 187, 45, 0.8);
        }
        #backBtn {
            position: absolute;
            bottom: 30px;
            background: linear-gradient(45deg, #ff5e62, #ff9966);
            color: white;
            box-shadow: 0 0 20px rgba(255, 94, 98, 0.5);
        }
        #backBtn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 94, 98, 0.8);
        }
    </style>
</head>
<body>
    <!-- åŠ¨æ€åœ£è¯æ ‘ç”»å¸ƒ -->
    <canvas id="christmasCanvas"></canvas>

    <!-- æ‰“å¼€ä¿¡ä»¶æŒ‰é’® -->
    <div class="btn-container">
        <button class="btn" id="openLetterBtn">A Letter For You ğŸ“œ</button>
    </div>

    <!-- ä¿¡ä»¶ç…§ç‰‡å®¹å™¨ï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div id="letterContainer">
        <img id="letterImg" src="letter.jpg" alt="My Christmas Letter For You">
        <button class="btn" id="backBtn">Back to Tree ğŸ„</button>
    </div>

    <script>
        // ========== 1. åŠ¨æ€åœ£è¯æ ‘+é›ªèŠ±æ ¸å¿ƒé€»è¾‘ ==========
        const canvas = document.getElementById('christmasCanvas');
        const ctx = canvas.getContext('2d');
        let w, h;

        // é€‚é…çª—å£å¤§å°
        function resizeCanvas() {
            w = window.innerWidth;
            h = window.innerHeight;
            canvas.width = w;
            canvas.height = h;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // é›ªèŠ±ç±»ï¼ˆé£˜è½+æ—‹è½¬ï¼‰
        class Snowflake {
            constructor() {
                this.x = Math.random() * w;
                this.y = Math.random() * h - h;
                this.size = Math.random() * 3 + 1;
                this.speed = Math.random() * 2 + 1;
                this.angle = Math.random() * Math.PI * 2;
                this.vx = Math.sin(this.angle) * 0.5;
            }
            update() {
                this.y += this.speed;
                this.x += this.vx;
                this.angle += 0.02;
                this.vx = Math.sin(this.angle) * 0.5;
                // é›ªèŠ±è½åˆ°åº•éƒ¨é‡ç½®
                if (this.y > h) {
                    this.x = Math.random() * w;
                    this.y = -20;
                }
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255,255,255,${0.7 + Math.random() * 0.3})`;
                ctx.fill();
            }
        }

        // ç”Ÿæˆé›ªèŠ±
        const snowflakes = [];
        for (let i = 0; i < 100; i++) snowflakes.push(new Snowflake());

        // ç»˜åˆ¶åœ£è¯æ ‘ï¼ˆåˆ†å±‚æ¸å˜+æ˜Ÿå…‰é—ªçƒï¼‰
        function drawTree() {
            const treeX = w / 2; // åœ£è¯æ ‘å±…ä¸­
            const treeHeight = h * 0.7; // æ ‘é«˜åº¦å å±å¹•70%
            const layers = 15; // æ ‘çš„å±‚æ•°ï¼ˆè¶Šå¤šè¶Šå¯†ï¼‰

            // ç»˜åˆ¶æ ‘å† ï¼ˆæ¸å˜ç»¿è‰²+éšæœºæ˜Ÿå…‰ï¼‰
            for (let i = 0; i < layers; i++) {
                const layerHeight = treeHeight / layers;
                const y = h * 0.1 + i * layerHeight; // æ ‘çš„èµ·å§‹ä½ç½®
                const width = (i + 1) * (w / 20); // æ¯å±‚å®½åº¦é€’å¢
                const green = 200 - i * 10; // ç»¿è‰²æ¸å˜ï¼ˆä»ä¸Šåˆ°ä¸‹æ›´æ·±ï¼‰
                const color = `rgb(${50 + i * 5}, ${green}, ${50 + i * 5})`;

                // ç»˜åˆ¶æ¯å±‚ä¸‰è§’å½¢
                ctx.beginPath();
                ctx.moveTo(treeX, y);
                ctx.lineTo(treeX - width, y + layerHeight);
                ctx.lineTo(treeX + width, y + layerHeight);
                ctx.closePath();
                ctx.fillStyle = color;
                ctx.fill();

                // éšæœºæ˜Ÿå…‰ï¼ˆç™½è‰²é—ªçƒç‚¹ï¼‰
                if (Math.random() > 0.7) {
                    const starX = treeX - width + Math.random() * width * 2;
                    const starY = y + Math.random() * layerHeight;
                    const starSize = Math.random() * 2 + 1;
                    ctx.beginPath();
                    ctx.arc(starX, starY, starSize, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255,255,255,${Math.random()})`;
                    ctx.fill();
                }
            }

            // ç»˜åˆ¶æ ‘å¹²
            const trunkWidth = w / 40;
            const trunkHeight = treeHeight / 5;
            ctx.fillStyle = '#8B4513'; // æ£•è¤è‰²æ ‘å¹²
            ctx.fillRect(
                treeX - trunkWidth / 2,
                h * 0.1 + treeHeight,
                trunkWidth,
                trunkHeight
            );

            // ç»˜åˆ¶æ ‘é¡¶æ˜Ÿæ˜Ÿ
            ctx.save();
            ctx.translate(treeX, h * 0.1 - 20);
            ctx.rotate(Math.sin(Date.now() / 1000) * 0.1); // æ˜Ÿæ˜Ÿè½»å¾®æ—‹è½¬
            drawStar(0, 0, 20, 10, '#FFD700'); // é‡‘è‰²æ˜Ÿæ˜Ÿ
            ctx.restore();
        }

        // ç»˜åˆ¶äº”è§’æ˜Ÿ
        function drawStar(x, y, outerR, innerR, color) {
            ctx.beginPath();
            for (let i = 0; i < 5; i++) {
                ctx.lineTo(
                    x + Math.cos((i * 144 - 90) * Math.PI / 180) * outerR,
                    y + Math.sin((i * 144 - 90) * Math.PI / 180) * outerR
                );
                ctx.lineTo(
                    x + Math.cos((i * 144 + 72 - 90) * Math.PI / 180) * innerR,
                    y + Math.sin((i * 144 + 72 - 90) * Math.PI / 180) * innerR
                );
            }
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();
            ctx.strokeStyle = '#FFF';
            ctx.strokeWidth = 1;
            ctx.stroke();
        }

        // åŠ¨ç”»å¾ªç¯
        function animate() {
            ctx.clearRect(0, 0, w, h);
            
            // ç»˜åˆ¶åœ£è¯æ ‘
            drawTree();
            
            // æ›´æ–°+ç»˜åˆ¶é›ªèŠ±
            snowflakes.forEach(snow => {
                snow.update();
                snow.draw();
            });
            
            requestAnimationFrame(animate);
        }
        animate();

        // ========== 2. æŒ‰é’®äº¤äº’é€»è¾‘ ==========
        const openLetterBtn = document.getElementById('openLetterBtn');
        const backBtn = document.getElementById('backBtn');
        const letterContainer = document.getElementById('letterContainer');

        // æ‰“å¼€ä¿¡ä»¶ç…§ç‰‡
        openLetterBtn.addEventListener('click', () => {
            letterContainer.style.display = 'flex';
        });

        // è¿”å›åœ£è¯æ ‘
        backBtn.addEventListener('click', () => {
            letterContainer.style.display = 'none';
        });

        // å…¼å®¹ç§»åŠ¨ç«¯ç‚¹å‡»
        openLetterBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            letterContainer.style.display = 'flex';
        });
        backBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            letterContainer.style.display = 'none';
        });
    </script>
</body>
</html>
